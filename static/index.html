<!DOCTYPE html>
<html>

    <head>
        <title>
            Fridge Magnet Poetry
        </title>
    </head>

    <script src="http://js.staging.pusher.com/3.0.0-pre/pusher.js"></script>
    <script src="/static/js/lib/processing.js"></script>
    <script src="/static/js/lib/reqwest.min.js"></script>
    <script src="/static/js/lib/ready.js"></script>
    <script src="/static/js/word.js"></script>
    <script src="/static/js/magnets.js"></script>
    <script>
        domready(function () {

            var canvas,
                processing,
                pushercfg,
                pusher,
                channel,
                urls;

            urls = {
                createword: '/word/'
            };

            pushercfg = {
                app: '93491',
                key: '4a4d7ef213beae63ed74',
                wsHost: 'ws-megabus.pusher.com',
                httpHost: 'sockjs-megabus.pusher.com'
            };

            document.getElementById("createWord").addEventListener("click", function (e) {
                var newword = document.getElementById("newWord").value
                console.log('new word', newword);
                reqwest({
                    url: urls.createword + newword,
                    method: 'post',
                    success: function (resp) {
                        console.log('sent word', resp);
                    }
                })
            });


            pusher = new Pusher(pushercfg.key, pushercfg);
            channel = pusher.subscribe('fridge');
            channel.bind('new-word', function (data) {
                console.log('got a new word', data)
            });


            canvas = document.getElementById('sketch');
            processing = new Processing(canvas, magnets);
        })
    </script>

    <body>

        <h1>Fridge Magnet Poetry</h1>
        <canvas id="sketch" ></canvas>
        <form onSubmit="return false" >
            New Word: <input id="newWord" type="text" name="word"><br>
            <input id="createWord" type="submit" value="Create">
        </form>

    </body>

</html>
